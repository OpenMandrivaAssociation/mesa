From 09855482046156a8186070620c1e2592ba59ff93 Mon Sep 17 00:00:00 2001
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
Date: Mon, 9 Oct 2023 16:50:13 +0300
Subject: [PATCH 015/834] anv: add missing workaround handling in simple shader
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

It's not going to make any real difference because of the type of
primitive used, but it feels safer to have this everywhere after a
3DPRIMITIVE.

Signed-off-by: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
Reviewed-by: Tapani PÃ¤lli <tapani.palli@intel.com>
Part-of: <https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/25618>
---
 src/intel/vulkan/genX_simple_shader.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/intel/vulkan/genX_simple_shader.c b/src/intel/vulkan/genX_simple_shader.c
index dd37d1b3395..f045903d83b 100644
--- a/src/intel/vulkan/genX_simple_shader.c
+++ b/src/intel/vulkan/genX_simple_shader.c
@@ -512,6 +512,7 @@ genX(emit_simple_shader_dispatch)(struct anv_simple_shader *state,
          prim.InstanceCount            = 1;
       }
       genX(emit_breakpoint)(batch, device, false);
+      genX(batch_emit_dummy_post_sync_op)(batch, device, _3DPRIM_RECTLIST, 3);
    } else {
       const struct intel_device_info *devinfo = device->info;
       const struct brw_cs_prog_data *prog_data =
-- 
2.42.0


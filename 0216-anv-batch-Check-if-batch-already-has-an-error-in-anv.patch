From ef8dcb0aa4b52e78c2925a0fef457812a1d4fe7b Mon Sep 17 00:00:00 2001
From: Jordan Justen <jordan.l.justen@intel.com>
Date: Wed, 11 Oct 2023 12:54:27 -0700
Subject: [PATCH 216/834] anv/batch: Check if batch already has an error in
 anv_queue_submit_simple_batch()

Signed-off-by: Jordan Justen <jordan.l.justen@intel.com>
Reviewed-by: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
Part-of: <https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/25672>
---
 src/intel/vulkan/anv_batch_chain.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/intel/vulkan/anv_batch_chain.c b/src/intel/vulkan/anv_batch_chain.c
index 14290c32341..fef06a78f0b 100644
--- a/src/intel/vulkan/anv_batch_chain.c
+++ b/src/intel/vulkan/anv_batch_chain.c
@@ -1602,6 +1602,9 @@ anv_queue_submit_simple_batch(struct anv_queue *queue,
    struct anv_device *device = queue->device;
    VkResult result = VK_SUCCESS;
 
+   if (anv_batch_has_error(batch))
+      return batch->status;
+
    if (queue->device->info->no_hw)
       return VK_SUCCESS;
 
-- 
2.42.0


From 6e20f820c60f25ceea08f9fa6c3916354c6f9834 Mon Sep 17 00:00:00 2001
From: Adam Jackson <ajax@redhat.com>
Date: Fri, 24 Mar 2023 11:10:54 -0400
Subject: [PATCH 482/834] docs: Mention 'meson devenv' in the pre-install test
 instructions

Also immunize ourselves against section renumbering.

Reviewed-by: Eric Engestrom <eric@igalia.com>
Part-of: <https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/25686>
---
 docs/install.rst | 33 +++++++++++++++++++++++----------
 1 file changed, 23 insertions(+), 10 deletions(-)

diff --git a/docs/install.rst b/docs/install.rst
index e75cfb9d627..40e1ce410f3 100644
--- a/docs/install.rst
+++ b/docs/install.rst
@@ -74,7 +74,7 @@ on the packaging tool used by your distro.
      apt-get build-dep mesa # Debian and derivatives
      ... # others
 
-2. Building with meson
+1. Building with meson
 ----------------------
 
 Meson is the latest build system in mesa, it is currently able to build
@@ -99,15 +99,28 @@ On Windows you can also use the Visual Studio backend
 Please read the :doc:`detailed meson instructions <meson>` for more
 information
 
-3. Running against a local build
---------------------------------
+1. Running against a local build (easy way)
+-------------------------------------------
 
 It's often necessary or useful when debugging driver issues or testing new
 branches to run against a local build of Mesa without doing a system-wide
-install.  To do this, choose a temporary location for the install.  A directory
-called ``installdir`` inside your mesa tree is as good as anything.  All of the
-commands below will assume ``$MESA_INSTALLDIR`` is an absolute path to this
-location.
+install. Meson has built-in support for this with its ``devenv`` subcommand:
+
+.. code-block:: console
+
+     meson devenv -C builddir glxinfo
+
+This will run the given command against the build in ``builddir``. Note that meson
+will ``chdir`` into the directory first, so any relative paths in the command line
+will be relative to ``builddir`` which may not be what you expect.
+
+1. Running against a local build (hard way)
+-------------------------------------------
+
+If you prefer you can configure your test environment manually. To do this,
+choose a temporary location for the install.  A directory called ``installdir``
+inside your mesa tree is as good as anything.  All of the commands below will
+assume ``$MESA_INSTALLDIR`` is an absolute path to this location.
 
 First, configure Mesa and install in the temporary location:
 
@@ -185,12 +198,12 @@ here are a few things to check:
     recently built 64-bit and are now building 32-bit, throw away the install
     directory first to prevent conflicts.
 
-4. Building with AOSP (Android)
+1. Building with AOSP (Android)
 -------------------------------
 
 <TODO>
 
-5. Library Information
+1. Library Information
 ----------------------
 
 When compilation has finished, look in the top-level ``lib/`` (or
@@ -221,7 +234,7 @@ If you built the DRI hardware drivers, you'll also see the DRI drivers:
 If you built with Gallium support, look in lib/gallium/ for
 Gallium-based versions of libGL and device drivers.
 
-6. Building OpenGL programs with pkg-config
+1. Building OpenGL programs with pkg-config
 -------------------------------------------
 
 Running ``meson install`` will install package configuration files for
-- 
2.42.0

